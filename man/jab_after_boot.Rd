% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jab_after_boot.R
\name{jab_after_boot}
\alias{jab_after_boot}
\title{Jackknife-after-Bootstrap (JAB) influence for lavaan bootstrap results}
\usage{
jab_after_boot(
  fit,
  param,
  standardized = TRUE,
  top_k = 5L,
  ci_level = 0.95,
  min_keep = NULL,
  plot = FALSE,
  plot_engine = c("ggplot2", "base"),
  ylab_override = NULL,
  verbose = TRUE,
  font_family = "sans"
)
}
\arguments{
\item{fit}{A \code{lavaan} object for which \code{store_boot(keep.idx = TRUE)} has been called.
Must contain \code{fit@external$sbt_boot_ustd} (with \code{boot.idx} attribute) and typically \code{sbt_boot_std}.}

\item{param}{Character(1). Target parameter. Accepts \code{"lhs op rhs"}, a \code{":="} label, or a free-parameter label.}

\item{standardized}{Logical. If \code{TRUE}, use standardized bootstrap; else unstandardized.}

\item{top_k}{Integer. Number of top cases (by \verb{|JAB_value|}) to report.}

\item{ci_level}{Numeric (0,1). Percentile CI level for LOO subdistributions.}

\item{min_keep}{Integer. Minimum number of bootstrap replicates kept in each LOO subset;
default \code{max(30, floor(0.2 * B))}.}

\item{plot}{Logical. If \code{TRUE}, draw a JAB diagnostic plot.}

\item{plot_engine}{Character. Plot engine for \code{plot = TRUE}. One of \code{"ggplot2"} or \code{"base"}.
Default \code{"ggplot2"} if available, otherwise \code{"base"}.}

\item{ylab_override}{Optional character. Override the default y-axis label in the plot.}

\item{verbose}{Logical. If \code{TRUE}, print compact summaries.}

\item{font_family}{Character. Graphics font family (e.g., \code{"serif"}, \code{"sans"}, \code{"Times New Roman"}).}
}
\value{
A list with:
\describe{
\item{\code{param}}{The target parameter string.}
\item{\code{standardized}}{Logical flag as input.}
\item{\code{full_summary}}{Data frame with ALL distribution summary:
\code{scope="ALL"}, \code{param}, \code{mean}, \code{SE}, \code{CI.Lo}, \code{CI.Up}.}
\item{\code{cases_summary}}{Data frame (top \code{top_k}) with columns:
\code{case}, \code{JAB_value}, \code{mean}, \code{SE}, \code{CI.Lo}, \code{CI.Up}.}
\item{\code{F}}{The occurrence matrix \eqn{B \times n}.}
\item{\code{tstar}}{Full bootstrap vector for \code{param}.}
}
}
\description{
Compute Jackknife-after-Bootstrap (JAB) influence values for a single
model parameter and diagnose observation-level influence by comparing
the full bootstrap distribution with leave-one-out (LOO) subdistributions
obtained via \code{boot.idx} (stored by \code{store_boot(keep.idx = TRUE)}).

The ALL-summary (mean/SE/CI) is taken directly and consistently from
\code{standardizedSolution_boot()} (standardized case) or
\code{parameterEstimates_boot()} (unstandardized case). JAB influence is
defined as \eqn{I_j = n\{\bar\theta_{(-j)} - \bar\theta\}}, where
\eqn{\bar\theta} is the bootstrap mean over all replicates, and
\eqn{\bar\theta_{(-j)}} is the bootstrap mean over the replicates that
exclude observation \eqn{j}.
}
\details{
Parameter identification is robust: it accepts \code{"lhs op rhs"},
\code{":="} user-defined name, and \emph{label}. For unstandardized cases,
if \code{label} is given and the column is missing in
\code{attr(unstd_boot, "boot_est_ustd")}, the function will fall back to
the raw matrix \code{fit@external$sbt_boot_ustd} if a column with that label
exists (e.g., \code{"b"}), keeping SE/CI from the \code{parameterEstimates_boot()}
row if available.
}
\seealso{
\code{\link{store_boot}}, \code{\link{standardizedSolution_boot}},
\code{\link{parameterEstimates_boot}}
}
